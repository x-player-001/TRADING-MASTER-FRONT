# Trading Master å‰ç«¯ â€” é¢è¯•é¢˜ä¸å‚è€ƒç­”æ¡ˆ

æœ¬æ–‡æ¡£ä¸ºå›´ç»• `trading-master-front` é¡¹ç›®å‡†å¤‡çš„ä¸€å¥—é¢è¯•é¢˜ï¼ˆå«å¯é€‰è¿½é—®ï¼‰ä¸å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼Œä¾¿äºé¢è¯•å®˜å‡ºé¢˜å’Œå€™é€‰äººå¤ä¹ ã€‚

> æ–‡ä»¶ç»“æ„ï¼š
> - é—®é¢˜æŒ‰ä¸»é¢˜åˆ†ç»„ï¼ˆåŸºç¡€ç†è§£ã€å®ç°ç»†èŠ‚ã€æ¶æ„è®¾è®¡ã€æ€§èƒ½ä¸æµ‹è¯•ã€å®‰å…¨ä¸è¿ç»´ã€è¡Œä¸º/åä½œï¼‰
> - æ¯é¢˜åŒ…å«ï¼šé—®é¢˜ã€è¯„åˆ†è¦ç‚¹ã€å¯é€‰è¿½é—®ã€å‚è€ƒç­”æ¡ˆè¦ç‚¹

---

## ä½¿ç”¨è¯´æ˜
- å»ºè®®æ—¶é•¿ï¼šåˆçº§/ä¸­çº§å€™é€‰äºº 30-45 åˆ†é’Ÿï¼›é«˜çº§å€™é€‰äºº 45-60 åˆ†é’Ÿã€‚
- è¯„åˆ†å»ºè®®ï¼šæ¯é¢˜æŒ‰ "æ­£ç¡®æ€§ã€æ·±åº¦ã€ä¸¾ä¾‹ã€å·¥ç¨‹å®è·µ" å››é¡¹åˆ†åˆ«æ‰“åˆ†ï¼ˆæ»¡åˆ† 4 åˆ†ï¼‰ï¼Œç»¼åˆå†³å®šæ˜¯å¦é€šè¿‡ã€‚

---

## ä¸€ã€åŸºç¡€ç†è§£

### 1. è¯·ç®€è¦æè¿°è¿™ä¸ªé¡¹ç›®çš„ä¸»è¦åŠŸèƒ½ä¸ç›®æ ‡ç”¨æˆ·æ˜¯è°ï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼š
  - èƒ½è¯´æ˜é¡¹ç›®ä¸ºåŠ å¯†è´§å¸/æ•°å­—èµ„äº§äº¤æ˜“ä¸é‡åŒ–å‰ç«¯å¹³å°
  - ä¸»è¦åŠŸèƒ½åŒ…å« K çº¿å›¾ã€ä¿¡å·å±•ç¤ºã€ç»“æ„æ£€æµ‹ã€å†å²å›å¡«ã€é‡åŒ–é¡µé¢ç­‰
  - ç›®æ ‡ç”¨æˆ·ï¼šé‡åŒ–äº¤æ˜“å‘˜ã€é£æ§ã€è¿è¥äººå‘˜
- å¯é€‰è¿½é—®ï¼šä½ åœ¨é¡¹ç›®é‡Œè´Ÿè´£å“ªä¸€éƒ¨åˆ†ï¼Ÿé‡åˆ°çš„ä¸»è¦æŒ‘æˆ˜æ˜¯ä»€ä¹ˆï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - é¡¹ç›®ç”¨äºå±•ç¤ºå®æ—¶åŠå†å² K çº¿ã€äº¤æ˜“ä¿¡å·ã€ç»“æ„/é€šé“åˆ†æã€ç›‘æ§ç³»ç»ŸçŠ¶æ€ã€é‡åŒ–ç­–ç•¥ç®¡ç†ç­‰ï¼›ä»¥äº¤æ˜“/é‡åŒ–äººå‘˜ä¸ºä¸»

### 2. è¿™ä¸ªé¡¹ç›®ä½¿ç”¨äº†å“ªäº›ä¸»è¦å‰ç«¯æŠ€æœ¯æ ˆï¼Ÿä¸ºä»€ä¹ˆé€‰æ‹©å®ƒä»¬ï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šåˆ—å‡º React 18ã€TypeScriptã€Viteã€Ant Designã€Zustandã€React Queryã€socket.io-clientã€lightweight-charts/recharts ç­‰ï¼Œå¹¶è§£é‡Šé€‰æ‹©ç†ç”±
- å¯é€‰è¿½é—®ï¼šæœ‰æ²¡æœ‰è€ƒè™‘æ›¿ä»£æ–¹æ¡ˆï¼ˆReduxã€Next.jsï¼‰ï¼Œä¸ºä»€ä¹ˆæœªé‡‡ç”¨ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - React/TypeScript ä¿è¯ç±»å‹å®‰å…¨ä¸ç»„ä»¶åŒ–ï¼›Vite æé«˜å¼€å‘é€Ÿåº¦ï¼›AntD æä¾› UI åŸºç¡€ï¼›Zustand è½»é‡çŠ¶æ€ç®¡ç†ï¼ŒReact Query å¤„ç†è¿œç¨‹ç¼“å­˜ä¸è½®è¯¢ï¼›socket.io ç”¨äºå®æ—¶ï¼›å›¾è¡¨åº“é€‰ lightweight-charts/tradingView é£æ ¼ä»¥ä¿è¯æ€§èƒ½

### 3. åº”ç”¨çš„å…¥å£å’Œè·¯ç”±æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šè¯´æ˜ `src/main.tsx` -> `src/App.tsx`ï¼ŒApp ä½¿ç”¨ hash è§£æå®ç°é¡µé¢åˆ‡æ¢ï¼ˆæœªä½¿ç”¨ react-router çš„ declarative è·¯ç”±ï¼‰
- å¯é€‰è¿½é—®ï¼šä¸ºä»€ä¹ˆ prefer ä½¿ç”¨ react-routerï¼Ÿå¦‚ä½•è¿ç§»ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - main.tsx æŒ‚è½½ Appï¼ŒApp å†…ç›‘å¬ `window.location.hash` å¹¶åˆ‡æ¢é¡µé¢ã€‚æ¨èæ”¹ç”¨ `react-router-dom` ä»¥è·å¾—æ›´å¥½ URL ç®¡ç†å’Œæ‡’åŠ è½½æ”¯æŒ

---

## äºŒã€ä»£ç å®ç°ä¸ç»†èŠ‚

### 4. è¯·è®²ä¸€ä¸‹ `KlineChart.tsx` çš„æ•°æ®æµï¼šæ•°æ®ä»å“ªé‡Œæ¥ï¼Œå¦‚ä½•å±•ç¤ºåœ¨å›¾è¡¨ä¸Šï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šè¯´æ˜ hooks -> services -> APIï¼›klineUtils è½¬æ¢æ•°æ®æ ¼å¼ï¼›TradingViewChart æ¥æ”¶ processed data
- å¯é€‰è¿½é—®ï¼šå¦‚æœåç«¯è¿”å›æ•°æ®å»¶è¿Ÿæˆ–ä¸¢å¸§ï¼Œé¡µé¢å¦‚ä½•ä¼˜é›…é™çº§ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - æ•°æ®ç”± `useKlineData`, `useSignalData`, `useStructureData`, `useChanData` ç­‰ hooks è·å–ï¼Œhooks è°ƒç”¨ `services/*` APIï¼›åœ¨å‰ç«¯è½¬æ¢ä¸º TradingView æ‰€éœ€çš„ candlestick/volume æ ¼å¼ï¼›TradingViewChart æ¸²æŸ“
  - ä¼˜é›…é™çº§ï¼šæ˜¾ç¤º loading/é”™è¯¯ä¿¡æ¯ï¼Œä½¿ç”¨ç¼“å­˜æ•°æ®ã€èŠ‚æµæ›´æ–°ã€å›é€€åˆ°è½®è¯¢æˆ–æç¤ºç”¨æˆ·

### 5. `useKlineData` ä¸»è¦è´Ÿè´£ä»€ä¹ˆï¼Ÿæœ‰å“ªäº›å¯æ‰©å±•æˆ–éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šè´Ÿè´£æ‹‰å– klineã€åˆ·æ–°é€»è¾‘ã€limitã€integrityã€error handlingï¼›æ³¨æ„ç‚¹åŒ…æ‹¬è¯·æ±‚å–æ¶ˆã€èŠ‚æµã€ç¼“å­˜ä¸€è‡´æ€§
- å¯é€‰è¿½é—®ï¼šå¦‚ä½•ä¸º `useKlineData` å¢åŠ ç¼“å­˜å’Œç¦»çº¿æ”¯æŒï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - ä½¿ç”¨ React Query åšç¼“å­˜ä¸é‡è¯•æ˜¯åˆç†é€‰æ‹©ï¼›å¯ç”¨ IndexedDB ç¼“å­˜ç¦»çº¿æ•°æ®ï¼Œæˆ–æœ¬åœ°æŒä¹…åŒ–æœ€è¿‘æ•°æ®ï¼›ä½¿ç”¨ AbortController å–æ¶ˆè¯·æ±‚å¹¶åœ¨ hook æ¸…ç†æ—¶å–æ¶ˆ

### 6. `services/apiClient.ts` çš„èŒè´£ä¸é”™è¯¯å¤„ç†ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šç»Ÿä¸€ axios å®ä¾‹ã€è®¾ç½® baseURLã€æ‹¦æˆªå™¨å¤„ç† tokenã€ç»Ÿä¸€é”™è¯¯æ ¼å¼ã€è¶…æ—¶åŠé‡è¯•ç­–ç•¥
- å¯é€‰è¿½é—®ï¼šå¦‚ä½•å®ç°å¹‚ç­‰æˆ–é¿å…é‡å¤è¯·æ±‚ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - apiClient ç®¡ç† HTTP å®¢æˆ·ç«¯é…ç½®ï¼Œæ³¨å…¥ auth tokenï¼Œå¤„ç† 401/403ï¼ˆé‡å®šå‘/åˆ·æ–° tokenï¼‰ï¼Œå¯¹ç½‘è·¯é”™è¯¯é‡‡å–ç»Ÿä¸€æç¤ºå’Œå¯é…ç½®çš„é‡è¯•é€»è¾‘ï¼›é¿å…é‡å¤è¯·æ±‚å¯ä»¥åœ¨ client å±‚åˆå¹¶ç›¸åŒè¯·æ±‚æˆ–åœ¨æœåŠ¡ç«¯æä¾›å¹‚ç­‰æ¥å£

### 7. ä¸ºä»€ä¹ˆåŒæ—¶ä½¿ç”¨äº† React çš„å±€éƒ¨ state ä¸ Zustandï¼Ÿå¦‚ä½•å†³å®šçŠ¶æ€æ”¾åœ¨å“ªï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šèƒ½åŒºåˆ†æœ¬åœ° UI çŠ¶æ€ä¸è·¨ç»„ä»¶å…±äº«çŠ¶æ€çš„èŒè´£ï¼›Zustand ç”¨äºè·¨ç»„ä»¶å…±äº«ï¼ˆè½»é‡ï¼‰
- å¯é€‰è¿½é—®ï¼šå¦‚æœ selectedSymbol éœ€è¦åœ¨å¤šä¸ªé¡µé¢ä¹‹é—´å…±äº«ï¼Œä½ ä¼šæ”¾åœ¨å“ªé‡Œï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - é€‰æ‹©åŸåˆ™ï¼šçŸ­æœŸä»…ç»„ä»¶å†…ä½¿ç”¨æ”¾ React stateï¼›è·¨ç»„ä»¶æˆ–æŒä¹…åŒ–çŠ¶æ€æ”¾ Zustand æˆ– React Query çš„ cache

---

## ä¸‰ã€æ¶æ„ä¸è®¾è®¡å†³ç­–

### 8. hooks/services/components çš„è¾¹ç•Œåº”å¦‚ä½•åˆ’åˆ†ï¼Ÿè¯·ä¸¾ä¾‹è¯´æ˜ã€‚
- è¯„åˆ†è¦ç‚¹ï¼šhooks åšå‰¯ä½œç”¨ï¼ˆæ•°æ®è·å–/çŠ¶æ€ç®¡ç†ï¼‰ï¼Œservices åš API è°ƒç”¨/è½¬æ¢ï¼Œcomponents ä»…æ¸²æŸ“ä¸ç”¨æˆ·äº¤äº’
- å¯é€‰è¿½é—®ï¼šä¿¡å·ç”Ÿæˆé€»è¾‘æ”¾åœ¨å“ªå±‚ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - ä¿¡å·ç”Ÿæˆè‹¥ä¸ºè½»é‡é€»è¾‘å¯æ”¾å‰ç«¯ hooksï¼›å¤æ‚/æ€§èƒ½å¯†é›†æˆ–éœ€å…±äº«ç»“æœåº”æ”¾åç«¯ï¼Œå‰ç«¯ä»…ä½œä¸ºè§¦å‘ä¸å±•ç¤º

### 9. å®æ—¶æ•°æ®æ›´æ–°å¦‚ä½•ä¿è¯ç¨³å®šä¸æ€§èƒ½ï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šä½¿ç”¨ socket.ioï¼Œé‡è¿ç­–ç•¥ã€å»æŠ–åˆå¹¶ã€å–æ¶ˆè®¢é˜…ã€åœ¨é«˜é¢‘æ¨é€æ—¶ throttle æˆ– batch updates
- å¯é€‰è¿½é—®ï¼šsocket åœ¨ç»„ä»¶å¸è½½æ—¶å¦‚ä½•æ¸…ç†ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - åœ¨ effect cleanup ä¸­è°ƒç”¨ socket.off/closeï¼Œç»Ÿä¸€ç®¡ç†è¿æ¥ç”Ÿå‘½å‘¨æœŸï¼ˆå¯ç”¨ Providerï¼‰å¹¶åœ¨æ–­è¿æ—¶å›é€€åˆ°è½®è¯¢

### 10. å¦‚æœæ‹†æˆ micro-frontendsï¼Œä½ ä¼šå¦‚ä½•æ‹†åˆ†ï¼Ÿæœ‰å“ªäº›éš¾ç‚¹ï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šæŒ‰åŠŸèƒ½åŸŸæ‹†åˆ†ï¼Œä½¿ç”¨ Module Federation æˆ– micro-appï¼Œæ³¨æ„å…±äº« React ç‰ˆæœ¬ã€æ ·å¼å†²çªã€å…¨å±€çŠ¶æ€ä¸è·¯ç”±
- è¿½é—®ï¼šå¦‚ä½•å…±äº«ç»„ä»¶åº“å’ŒçŠ¶æ€ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - å…±äº«ç»„ä»¶åº“å‘å¸ƒä¸ºå†…éƒ¨åŒ…æˆ–é€šè¿‡ CDNï¼›å…¨å±€çŠ¶æ€é€šè¿‡ç»Ÿä¸€ API æˆ– shared storeï¼Œæˆ–å‡å°‘å…±äº«çŠ¶æ€ï¼ŒæŠŠäº¤äº’é€šè¿‡åç«¯/URL å‚æ•°æˆ–äº‹ä»¶æ€»çº¿ä¼ é€’

---

## å››ã€æ€§èƒ½ã€æ‰©å±•æ€§ä¸å¯æµ‹æ€§

### 11. K çº¿é¡µé¢å¤§é‡æ•°æ®æ—¶æœ‰å“ªäº›æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šcanvas vs SVGã€å›¾è¡¨åº“é€‰å‹ã€å‡å°‘é‡æ¸²æŸ“ï¼ˆmemoizationï¼‰ã€WebWorkerã€åˆ†é¡µ/åˆ†æ®µæ¸²æŸ“ã€è™šæ‹ŸåŒ–
- å¯é€‰è¿½é—®ï¼šå¦‚ä½•å®šä½æ¸²æŸ“ç“¶é¢ˆï¼Ÿä½¿ç”¨å“ªäº›å·¥å…·ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - ä½¿ç”¨ profilerï¼ˆReact DevToolsï¼‰ã€æµè§ˆå™¨æ€§èƒ½é¢æ¿ã€record æ€§èƒ½å¿«ç…§ï¼›å¯¹çƒ­ç‚¹å‡½æ•°åšä¼˜åŒ–æˆ–è¿ç§»åˆ° worker

### 12. å¦‚ä½•ä¸ºå…³é”®ç®—æ³•ï¼ˆå¦‚ klineUtilsã€structure detectionï¼‰å†™æµ‹è¯•ï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šå•å…ƒæµ‹è¯•è¦†ç›–è½¬æ¢é€»è¾‘ä¸è¾¹ç•Œæƒ…å†µã€é›†æˆæµ‹è¯• mock APIã€ç»„ä»¶æµ‹è¯•è¦†ç›–äº¤äº’
- è¿½é—®ï¼šä¼˜å…ˆå†™å“ªäº›æµ‹è¯•ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - ä¼˜å…ˆå†™çº¯å‡½æ•°ä¸è½¬æ¢é€»è¾‘çš„å•å…ƒæµ‹è¯•ï¼›ç½‘ç»œé€»è¾‘ç”¨ mockï¼›UI è¡Œä¸ºç”¨ RTL

### 13. ç”Ÿäº§ç¯å¢ƒå¦‚ä½•ç›‘æ§å‰ç«¯æ€§èƒ½ä¸é”™è¯¯ï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šä½¿ç”¨ Sentry/Datadog/LogRocketï¼›åŸ‹ç‚¹å…³é”®æ€§èƒ½æŒ‡æ ‡ï¼ˆFCP, LCP, TTFBï¼‰ï¼Œæ¥å£å»¶è¿Ÿä¸é”™è¯¯ç‡å‘Šè­¦
- è¿½é—®ï¼šé‡åˆ°æ¥å£å¤§é‡å¤±è´¥å¦‚ä½•æ’æŸ¥ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - æŸ¥çœ‹å †æ ˆ/ç½‘ç»œæ—¥å¿—ã€è¿½è¸ªè¯·æ±‚ idã€å›æ»šåˆ°ç¨³å®šç‰ˆæœ¬ã€æ ¹æ®é”™è¯¯ç±»å‹å‡çº§å‘Šè­¦çº§åˆ«

---

## äº”ã€å®‰å…¨ã€éƒ¨ç½²ä¸ç»´æŠ¤

### 14. å‰ç«¯å¦‚ä½•å¤„ç†æ•æ„Ÿä¿¡æ¯ï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šä¸åœ¨å‰ç«¯ä¿å­˜æ•æ„Ÿ keyï¼›ä½¿ç”¨åç«¯ä»£ç†æˆ–çŸ­æœŸ tokenï¼›ç”Ÿäº§ä½¿ç”¨ HTTPS ä¸ HttpOnly cookie
- è¿½é—®ï¼šå¦‚ä½•åš token ç»­æœŸï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - ä½¿ç”¨ refresh token æµç¨‹ï¼Œrefresh åœ¨åç«¯æˆ–é€šè¿‡å®‰å…¨ cookie æ¥å£å®Œæˆï¼Œå‰ç«¯è§¦å‘åˆ·æ–°å¹¶é‡è¯•å¤±è´¥è¯·æ±‚

### 15. ä½ ä¼šå¦‚ä½•è®¾è®¡ CI/CD æµæ°´çº¿ï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šCI åŒ…å« lint -> typecheck -> test -> buildï¼›CD å‘å¸ƒåˆ°é™æ€æ‰˜ç®¡æˆ–å®¹å™¨ï¼Œå¯ç”¨ç°åº¦å‘å¸ƒä¸å›æ»š
- è¿½é—®ï¼šå¦‚ä½•åœ¨ CI æ£€æŸ¥æ€§èƒ½å›å½’ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - åœ¨ CI ä¸­åŠ å…¥è½»é‡æ€§èƒ½æµ‹è¯•ï¼ˆbundle size æ£€æŸ¥ã€å…³é”®é¡µé¢åŠ è½½æ—¶é—´é˜ˆå€¼ï¼‰ï¼Œæˆ–æŠŠæ€§èƒ½åŸºçº¿å­˜å‚¨å¹¶å¯¹æ¯”

### 16. ç‰ˆæœ¬å›é€€ä¸å…¼å®¹æ€§å¦‚ä½•ä¿è¯ï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šä½¿ç”¨é™æ€èµ„æº hashã€CDN ç¼“å­˜ç­–ç•¥ã€åç«¯å…¼å®¹å¥‘çº¦ã€feature flagsã€å¿«é€Ÿå›æ»šæµç¨‹
- è¿½é—®ï¼šåç«¯æ•°æ®æ¨¡å‹å˜æ›´å¯¼è‡´å‰ç«¯æŠ¥é”™ï¼Œå¦‚ä½•å¿«é€Ÿæ¢å¤ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - æš‚æ—¶å›æ»šå‰ç«¯åˆ°å…¼å®¹ç‰ˆæœ¬æˆ–æ›´æ–°å‰ç«¯ code ä¸­çš„å…¼å®¹å±‚ï¼›åœ¨æœåŠ¡ç«¯åšå…¼å®¹å±‚æˆ–å¯¹å¤–æä¾›æ—§ç‰ˆæœ¬æ¥å£

---

## å…­ã€è¡Œä¸ºä¸åä½œ

### 17. åç«¯é¢‘ç¹å˜æ›´æ¥å£å¯¼è‡´å‰ç«¯ç ´åæ—¶ä½ ä¼šæ€ä¹ˆåšï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šæ¨è¿›æ¥å£å¥‘çº¦ï¼ˆOpenAPIï¼‰ã€mock serverã€å†™å…¼å®¹é€‚é…å±‚ã€åœ¨ PR ä¸­è¿›è¡Œè”è°ƒ
- è¿½é—®ï¼šå¦‚ä½•åœ¨ç¼ºæ–‡æ¡£æ—¶å¿«é€Ÿå®šä½é—®é¢˜ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - ä½¿ç”¨æŠ“åŒ…å·¥å…·ã€é˜…è¯»åç«¯ä»£ç ã€æ‰“å°è¿”å›ä½“ã€ä¸´æ—¶ mock å¹¶å†™é›†æˆæµ‹è¯•

### 18. å¦‚ä½•ä¿è¯ä»£ç è´¨é‡ä¸ä¸€è‡´æ€§ï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šä½¿ç”¨ ESLint/Prettierã€ä»£ç  reviewã€CI å¼ºåˆ¶ã€å…±äº«ç»„ä»¶ä¸æ–‡æ¡£ã€å•å…ƒæµ‹è¯•è¦†ç›–ç›®æ ‡
- è¿½é—®ï¼šé¢å¯¹å¤§å‹ PR éš¾ä»¥ reviewï¼Œä½ æ€ä¹ˆåšï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - åˆ†æ‹† PRã€å…ˆææ¥å£ä¸è®¾è®¡æ–‡æ¡£ã€å°æ­¥æäº¤ã€åœ¨ PR æè¿°ä¸­åˆ—å‡ºé‡ç‚¹å˜æ›´ç‚¹

---

## ä¸ƒã€æ·±å…¥ç³»ç»Ÿè®¾è®¡ï¼ˆé«˜çº§ï¼‰

### 19. ç”»å‡º `triggerDetection` ä¸ `backfill` çš„æ•°æ®æµä¸æ—¶åºï¼ŒæŒ‡å‡ºç«æ€æ¡ä»¶å¹¶ç»™å‡ºè§£å†³æ–¹æ¡ˆã€‚
- è¯„åˆ†è¦ç‚¹ï¼šèƒ½ç”»å‡º UI -> hook -> services -> API -> DB çš„æµç¨‹ï¼Œè¯†åˆ«å¹¶å‘å†™å…¥ã€éƒ¨åˆ†æˆåŠŸã€é‡å¤å†™å…¥ã€é˜Ÿåˆ—åŒ–/å¹‚ç­‰ç­–ç•¥
- å¯é€‰è¿½é—®ï¼šå¦‚ä½•åœ¨å‰ç«¯å±•ç¤ºä»»åŠ¡è¿›åº¦ä¸é”™è¯¯æ˜ç»†ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - å‰ç«¯è§¦å‘åç«¯å¼‚æ­¥ä»»åŠ¡ï¼Œè¿”å› task idï¼›å‰ç«¯è½®è¯¢æˆ–è®¢é˜… websocket è·å–ä»»åŠ¡è¿›åº¦ï¼›è§£å†³ç«æ€ï¼šåç«¯ä¿è¯å¹‚ç­‰ã€å»é‡ï¼Œå‰ç«¯ç¦ç”¨é‡å¤è§¦å‘æˆ–æŒ‰åºæ’é˜Ÿ

### 20. å¦‚æœæŠŠç»“æ„æ£€æµ‹ç‹¬ç«‹ä¸ºåç«¯æ‰¹å¤„ç†/æµå¼æœåŠ¡ï¼Œä½ å¦‚ä½•è®¾è®¡ API ä¸å‰ç«¯äº¤äº’ï¼Ÿ
- è¯„åˆ†è¦ç‚¹ï¼šè®¾è®¡è§¦å‘ä»»åŠ¡æ¥å£ã€ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢ã€ç»“æœè·å–ï¼›æ”¯æŒå¼‚æ­¥å›è°ƒæˆ– WebSocket æ¨é€ï¼›è€ƒè™‘å¹‚ç­‰ä¸é‡è¯•
- å¯é€‰è¿½é—®ï¼šä»»åŠ¡ç»“æœå¦‚ä½•å½’æ¡£å’Œå›æº¯ï¼Ÿ
- å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š
  - åç«¯æä¾›ä»»åŠ¡å­˜å‚¨ï¼ˆtask idã€çŠ¶æ€ã€æ—¥å¿—ï¼‰ï¼Œå‰ç«¯å¯è®¢é˜…æˆ–è½®è¯¢ï¼Œç»“æœå­˜å‚¨åœ¨ DB å¹¶é€šè¿‡åˆ†é¡µ/æŸ¥è¯¢ API è·å–

---

## å…«ã€æ¥å£æ•°æ®å¤„ç†æ¶æ„ï¼ˆæ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼‰â­

### 21. è¯·è¯¦ç»†è¯´æ˜é¡¹ç›®çš„æ¥å£æ•°æ®å¤„ç†å±‚æ¬¡æ¶æ„ï¼ŒczscApiClientã€strategyAPIã€CZSCStrategy å„è‡ªçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ

**è¿™æ˜¯æœ€æ ¸å¿ƒçš„æ¶æ„é—®é¢˜ï¼Œå»ºè®®é‡ç‚¹å‡†å¤‡ï¼**

#### ğŸ“Š å®Œæ•´æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    UI å±•ç¤ºå±‚ (View Layer)                    â”‚
â”‚  StrategyManage.tsx - ç”¨æˆ·çœ‹åˆ°çš„ç­–ç•¥ç®¡ç†é¡µé¢                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ props / hooks
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic)                  â”‚
â”‚  useStrategyData() - å°è£…ç­–ç•¥ç®¡ç†çš„ä¸šåŠ¡é€»è¾‘å’ŒçŠ¶æ€              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ API calls
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  API æœåŠ¡å±‚ (API Service)                     â”‚
â”‚  strategyAPI.getStrategies() - è¯­ä¹‰åŒ–çš„ä¸šåŠ¡APIæ–¹æ³•            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ format conversion
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               æ•°æ®è½¬æ¢å±‚ (Data Transform Layer)               â”‚
â”‚  convertFromCZSCStrategy() - CZSCæ ¼å¼ â†” å‰ç«¯æ ¼å¼              â”‚
â”‚  CZSCStrategy (åç«¯ç±»å‹) â†” StrategyConfig (å‰ç«¯ç±»å‹)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ HTTP requests
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              HTTP å®¢æˆ·ç«¯å±‚ (HTTP Client Layer)                â”‚
â”‚  czscApiClient - CZSCå›æµ‹ç³»ç»Ÿä¸“ç”¨HTTPå®¢æˆ·ç«¯ (:8000)           â”‚
â”‚  apiClient - Kçº¿æ•°æ®æœåŠ¡ä¸“ç”¨HTTPå®¢æˆ·ç«¯ (:3000)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ network
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åç«¯æœåŠ¡ (Backend API)                     â”‚
â”‚  CZSCå›æµ‹ç³»ç»Ÿ / Kçº¿æ•°æ®æœåŠ¡                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### è¯„åˆ†è¦ç‚¹ï¼š
1. **èƒ½æ¸…æ™°è¯´å‡º5å±‚æ¶æ„**: UIå±‚ â†’ ä¸šåŠ¡å±‚ â†’ APIæœåŠ¡å±‚ â†’ æ•°æ®è½¬æ¢å±‚ â†’ HTTPå®¢æˆ·ç«¯å±‚
2. **ç†è§£å„å±‚èŒè´£**: æ¯ä¸€å±‚åªåšä¸€ä»¶äº‹ï¼Œå•ä¸€èŒè´£åŸåˆ™
3. **è¯´æ˜æ•°æ®æµè½¬**: ä»ç”¨æˆ·æ“ä½œåˆ°åç«¯APIçš„å®Œæ•´æµç¨‹
4. **ä¸¾ä¾‹è¯´æ˜**: èƒ½ç”¨å®é™…ä»£ç ç¤ºä¾‹è¯´æ˜

#### å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š

**ç¬¬1å±‚ï¼šHTTPå®¢æˆ·ç«¯å±‚ï¼ˆczscApiClientï¼‰**

```typescript
// èŒè´£ï¼šç®¡ç†ä¸CZSCå›æµ‹ç³»ç»Ÿçš„æ‰€æœ‰HTTPé€šä¿¡
const czscApiClient = axios.create({
  baseURL: 'http://localhost:8000',
  timeout: 30000,  // å›æµ‹è€—æ—¶é•¿ï¼Œ30ç§’è¶…æ—¶
});

// è¯·æ±‚æ‹¦æˆªå™¨ï¼šæ·»åŠ æ—¥å¿—ã€token
czscApiClient.interceptors.request.use(config => {
  console.log('ğŸš€ CZSC APIè¯·æ±‚:', config.url);
  return config;
});

// å“åº”æ‹¦æˆªå™¨ï¼šç»Ÿä¸€é”™è¯¯å¤„ç†
czscApiClient.interceptors.response.use(
  response => response.data,
  error => {
    console.error('âŒ CZSC APIé”™è¯¯:', error);
    return Promise.reject(error);
  }
);
```

**ä½œç”¨**ï¼š
- âœ… å°è£…æ‰€æœ‰HTTPé€šä¿¡ç»†èŠ‚ï¼ˆè¶…æ—¶ã€é‡è¯•ã€æ—¥å¿—ï¼‰
- âœ… ç»Ÿä¸€é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- âœ… é…ç½®è¯·æ±‚å¤´ã€Base URLã€æ‹¦æˆªå™¨
- âœ… ä¸æ¶‰åŠä»»ä½•ä¸šåŠ¡é€»è¾‘

**ä¸ºä»€ä¹ˆéœ€è¦ä¸¤ä¸ªå®¢æˆ·ç«¯ï¼ˆczscApiClient + apiClientï¼‰ï¼Ÿ**
> "æˆ‘ä»¬é¡¹ç›®å¯¹æ¥ä¸¤ä¸ªåç«¯æœåŠ¡ï¼šCZSCå›æµ‹ç³»ç»Ÿ(:8000)å’ŒKçº¿æ•°æ®æœåŠ¡(:3000)ã€‚æ¯ä¸ªæœåŠ¡æœ‰ä¸åŒçš„ç‰¹ç‚¹ï¼š
> - CZSCå›æµ‹è€—æ—¶é•¿ â†’ 30ç§’è¶…æ—¶
> - Kçº¿æ•°æ®æŸ¥è¯¢å¿« â†’ 10ç§’è¶…æ—¶
> - CZSCä¸è§£åŒ…dataå­—æ®µï¼ŒKçº¿æœåŠ¡éœ€è¦è‡ªåŠ¨è§£åŒ…
>
> åˆ†å¼€ä¸¤ä¸ªå®¢æˆ·ç«¯å¯ä»¥ç‹¬ç«‹é…ç½®ï¼Œäº’ä¸å½±å“ï¼Œç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚"

---

**ç¬¬2å±‚ï¼šæ•°æ®è½¬æ¢å±‚ï¼ˆCZSCStrategy â†” StrategyConfigï¼‰**

```typescript
// CZSCStrategy - åç«¯APIè¿”å›çš„æ•°æ®æ ¼å¼
interface CZSCStrategy {
  strategy_id: string;        // åç«¯ç”¨å­—ç¬¦ä¸²ID
  name: string;
  is_active: boolean;         // åç«¯å‘½åé£æ ¼
  signals: CZSCStrategySignal[];
  entry_rules: { ... };
}

// StrategyConfig - å‰ç«¯ä¸šåŠ¡æ•°æ®æ ¼å¼
interface StrategyConfig {
  id: number;                 // å‰ç«¯ç”¨æ•°å­—IDï¼Œæ–¹ä¾¿æ“ä½œ
  name: string;
  enabled: boolean;           // å‰ç«¯ä¹ æƒ¯å‘½å
  type: 'breakout' | 'custom';
  parameters: { ... };
}

// è½¬æ¢å‡½æ•°ï¼šCZSCæ ¼å¼ â†’ å‰ç«¯æ ¼å¼
const convertFromCZSCStrategy = (czsc: CZSCStrategy): StrategyConfig => {
  return {
    id: parseInt(czsc.strategy_id.replace(/\D/g, '')),
    name: czsc.name,
    enabled: czsc.is_active,
    type: 'custom',
    parameters: {
      signals: czsc.signals,
      entry_rules: czsc.entry_rules
    }
  };
};
```

**ä½œç”¨**ï¼š
- âœ… è§£è€¦å‰åç«¯æ•°æ®æ ¼å¼ï¼ˆé€‚é…å™¨æ¨¡å¼ï¼‰
- âœ… ç±»å‹å®‰å…¨è½¬æ¢ï¼ˆTypeScriptç±»å‹å®šä¹‰ï¼‰
- âœ… å­—æ®µåæ˜ å°„ï¼ˆis_active â†’ enabledï¼‰
- âœ… æ•°æ®ç»“æ„é€‚é…ï¼ˆå­—ç¬¦ä¸²ID â†’ æ•°å­—IDï¼‰

**ä¸ºä»€ä¹ˆéœ€è¦è½¬æ¢å±‚ï¼Ÿ**
> "å¦‚æœç›´æ¥ä½¿ç”¨åç«¯æ•°æ®æ ¼å¼ï¼š
> 1. åç«¯å­—æ®µåå˜åŒ– â†’ æ‰€æœ‰UIç»„ä»¶éƒ½è¦æ”¹
> 2. åç«¯é€»è¾‘å˜åŒ– â†’ å‰ç«¯ä»£ç åˆ°å¤„æŠ¥é”™
> 3. å‰ç«¯å¼€å‘è¢«åç«¯ç»‘æ¶
>
> å¼•å…¥è½¬æ¢å±‚åï¼š
> 1. åç«¯APIå˜åŒ– â†’ åªéœ€ä¿®æ”¹è½¬æ¢å‡½æ•°
> 2. å‰ç«¯å®šä¹‰æœ€é€‚åˆè‡ªå·±çš„æ•°æ®æ ¼å¼
> 3. å‰åç«¯è§£è€¦ï¼Œå„è‡ªç‹¬ç«‹æ¼”è¿›"

---

**ç¬¬3å±‚ï¼šAPIæœåŠ¡å±‚ï¼ˆstrategyAPIï¼‰**

```typescript
export const strategyAPI = {
  // è·å–ç­–ç•¥åˆ—è¡¨
  getStrategies: async (): Promise<StrategyConfig[]> => {
    // 1. è°ƒç”¨HTTPå®¢æˆ·ç«¯
    const response = await czscApiGet<CZSCStrategyListResponse>(
      '/api/v1/strategy/list',
      { params: { limit: 100 } }
    );

    // 2. æ•°æ®è½¬æ¢ï¼šåç«¯æ ¼å¼ â†’ å‰ç«¯æ ¼å¼
    return response.strategies.map(convertFromCZSCStrategy);
  },

  // åˆ›å»ºç­–ç•¥
  createStrategy: async (data: Partial<StrategyConfig>): Promise<StrategyConfig> => {
    // 1. è½¬æ¢ï¼šå‰ç«¯æ ¼å¼ â†’ åç«¯æ ¼å¼
    const czscData = convertToCSCStrategy(data);

    // 2. å‘é€è¯·æ±‚
    const response = await czscApiPost('/api/v1/strategy', czscData);

    // 3. å¤„ç†å“åº”
    if (response.success) {
      const created = await czscApiGet(`/api/v1/strategy/${response.strategy_id}`);
      return convertFromCZSCStrategy(created);
    }

    throw new Error(response.message);
  }
};
```

**ä½œç”¨**ï¼š
- âœ… å°è£…ä¸šåŠ¡APIè°ƒç”¨ï¼ˆè¯­ä¹‰åŒ–æ–¹æ³•åï¼‰
- âœ… å¤„ç†è¯·æ±‚å‚æ•°å’ŒæŸ¥è¯¢å‚æ•°
- âœ… ç¼–æ’å¤šä¸ªAPIè°ƒç”¨ï¼ˆå¦‚åˆ›å»ºåå†æŸ¥è¯¢è¯¦æƒ…ï¼‰
- âœ… ä¸šåŠ¡çº§é”™è¯¯å¤„ç†
- âœ… è°ƒç”¨æ•°æ®è½¬æ¢å±‚

**ä¸ºä»€ä¹ˆéœ€è¦APIæœåŠ¡å±‚ï¼Ÿ**
> "å¦‚æœUIå±‚ç›´æ¥è°ƒç”¨HTTPå®¢æˆ·ç«¯ï¼š
> ```typescript
> // ä¸å¥½çš„åšæ³•
> const response = await czscApiGet('/api/v1/strategy/list');
> const strategies = response.strategies.map(s => ({
>   id: parseInt(s.strategy_id.replace(/\D/g, '')),
>   ...
> }));
> ```
>
> é—®é¢˜ï¼š
> 1. URLè·¯å¾„æ•£è½åœ¨å„å¤„ï¼Œéš¾ä»¥ç»´æŠ¤
> 2. æ•°æ®è½¬æ¢é€»è¾‘é‡å¤
> 3. ä¸šåŠ¡é€»è¾‘è€¦åˆåœ¨UIç»„ä»¶ä¸­
>
> ä½¿ç”¨APIæœåŠ¡å±‚åï¼š
> ```typescript
> // å¥½çš„åšæ³•
> const strategies = await strategyAPI.getStrategies();
> ```
>
> ä¼˜åŠ¿ï¼š
> 1. è¯­ä¹‰æ¸…æ™°ï¼Œä¸€çœ‹å°±æ‡‚
> 2. è½¬æ¢é€»è¾‘å°è£…ï¼Œä¸é‡å¤
> 3. URLå˜åŒ–åªéœ€æ”¹ä¸€å¤„"

---

**ç¬¬4å±‚ï¼šä¸šåŠ¡é€»è¾‘å±‚ï¼ˆuseStrategyDataï¼‰**

```typescript
export const useStrategyData = () => {
  const [strategies, setStrategies] = useState<StrategyConfig[]>([]);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  // åŠ è½½ç­–ç•¥åˆ—è¡¨
  const loadStrategies = async () => {
    setIsLoading(true);
    try {
      const data = await strategyAPI.getStrategies();
      setStrategies(data);
    } catch (err: any) {
      setError(err.message);
    } finally {
      setIsLoading(false);
    }
  };

  // åˆ›å»ºç­–ç•¥
  const createStrategy = async (data: Partial<StrategyConfig>) => {
    const newStrategy = await strategyAPI.createStrategy(data);
    setStrategies(prev => [...prev, newStrategy]);
  };

  useEffect(() => {
    loadStrategies();
  }, []);

  return { strategies, isLoading, error, createStrategy };
};
```

**ä½œç”¨**ï¼š
- âœ… ç®¡ç†é¡µé¢çº§çŠ¶æ€ï¼ˆloadingã€errorã€dataï¼‰
- âœ… å¤„ç†å‰¯ä½œç”¨ï¼ˆAPIè°ƒç”¨ã€å®šæ—¶å™¨ï¼‰
- âœ… å°è£…ä¸šåŠ¡é€»è¾‘ï¼Œå¤ç”¨åˆ°å¤šä¸ªç»„ä»¶
- âœ… å…³æ³¨ç‚¹åˆ†ç¦»ï¼ˆUIç»„ä»¶åªå…³æ³¨å±•ç¤ºï¼‰

---

**ç¬¬5å±‚ï¼šUIå±•ç¤ºå±‚ï¼ˆStrategyManage.tsxï¼‰**

```typescript
const StrategyManage: React.FC = () => {
  // ä»Hookè·å–æ•°æ®å’Œæ–¹æ³•
  const { strategies, isLoading, createStrategy } = useStrategyData();

  // ä»…å¤„ç†UIäº¤äº’
  const handleCreate = () => {
    setIsModalOpen(true);
  };

  return (
    <div>
      {isLoading ? <Loading /> : (
        strategies.map(strategy => (
          <StrategyCard key={strategy.id} data={strategy} />
        ))
      )}
    </div>
  );
};
```

**ä½œç”¨**ï¼š
- âœ… çº¯å±•ç¤ºç»„ä»¶
- âœ… æ¥æ”¶æ•°æ®å’Œå›è°ƒå‡½æ•°
- âœ… å¤„ç†ç”¨æˆ·äº¤äº’ï¼ˆç‚¹å‡»ã€è¾“å…¥ï¼‰
- âœ… ä¸æ¶‰åŠä¸šåŠ¡é€»è¾‘

---

#### ğŸ”„ å®Œæ•´æ•°æ®æµè½¬ç¤ºä¾‹ï¼ˆç”¨æˆ·ç‚¹å‡»"åˆ›å»ºç­–ç•¥"ï¼‰

```
1. UIå±‚
   ç”¨æˆ·ç‚¹å‡»æŒ‰é’® â†’ handleCreate() â†’ createStrategy(formData)
                                        â†“
2. ä¸šåŠ¡é€»è¾‘å±‚
   useStrategyData.createStrategy() â†’ strategyAPI.createStrategy(data)
                                        â†“
3. APIæœåŠ¡å±‚
   strategyAPI.createStrategy()
   â†’ convertToCSCStrategy(data)  // å‰ç«¯æ ¼å¼ â†’ CZSCæ ¼å¼
   â†’ czscApiPost('/api/v1/strategy', czscData)
                                        â†“
4. HTTPå®¢æˆ·ç«¯å±‚
   czscApiPost()
   â†’ è¯·æ±‚æ‹¦æˆªå™¨ï¼ˆæ·»åŠ æ—¥å¿—ï¼‰
   â†’ axios.post('http://localhost:8000/api/v1/strategy')
   â†’ å“åº”æ‹¦æˆªå™¨ï¼ˆå¤„ç†é”™è¯¯ï¼‰
                                        â†“
5. ç½‘ç»œå±‚
   HTTP POST â†’ CZSCæœåŠ¡å™¨
                                        â†“
6. åç«¯å“åº”
   { success: true, strategy_id: "xxx", message: "åˆ›å»ºæˆåŠŸ" }
                                        â†“
7. HTTPå®¢æˆ·ç«¯å±‚ï¼ˆå“åº”å¤„ç†ï¼‰
   å“åº”æ‹¦æˆªå™¨ â†’ è¿”å›ç»™APIæœåŠ¡å±‚
                                        â†“
8. APIæœåŠ¡å±‚ï¼ˆæ•°æ®è½¬æ¢ï¼‰
   convertFromCZSCStrategy(response)  // CZSCæ ¼å¼ â†’ å‰ç«¯æ ¼å¼
                                        â†“
9. ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆçŠ¶æ€æ›´æ–°ï¼‰
   setStrategies(prev => [...prev, newStrategy])
                                        â†“
10. UIå±‚ï¼ˆé‡æ–°æ¸²æŸ“ï¼‰
    Reactæ£€æµ‹åˆ°strategieså˜åŒ– â†’ é‡æ–°æ¸²æŸ“ç­–ç•¥åˆ—è¡¨
```

---

#### ğŸ¨ é‡‡ç”¨çš„è®¾è®¡æ¨¡å¼

1. **åˆ†å±‚æ¶æ„ (Layered Architecture)**
   - æ¯ä¸€å±‚åªä¾èµ–ä¸‹ä¸€å±‚ï¼Œä¸è·¨å±‚è°ƒç”¨

2. **é€‚é…å™¨æ¨¡å¼ (Adapter Pattern)**
   - è½¬æ¢å‡½æ•°è§£å†³å‰åç«¯æ ¼å¼ä¸å…¼å®¹

3. **å•ä¸€èŒè´£åŸåˆ™ (SRP)**
   - æ¯ä¸€å±‚åªåšä¸€ä»¶äº‹

4. **ä¾èµ–æ³¨å…¥ (DI)**
   - APIæœåŠ¡å±‚æ³¨å…¥HTTPå®¢æˆ·ç«¯

---

#### ğŸ’¡ é«˜é¢‘è¿½é—®åŠå›ç­”

**Q: ä¸ºä»€ä¹ˆè¦åˆ†è¿™ä¹ˆå¤šå±‚ï¼Ÿä¸æ˜¯å¢åŠ å¤æ‚åº¦å—ï¼Ÿ**

A: "åˆ†å±‚çš„åˆæœŸç¡®å®ä¼šå¢åŠ ä»£ç é‡ï¼Œä½†é•¿æœŸçœ‹ï¼š
1. **å¯ç»´æŠ¤æ€§**: åç«¯APIå˜åŒ–æ—¶ï¼Œåªéœ€ä¿®æ”¹è½¬æ¢å±‚
2. **å¯æµ‹è¯•æ€§**: æ¯ä¸€å±‚å¯ä»¥ç‹¬ç«‹æµ‹è¯•
3. **å¤ç”¨æ€§**: HTTPå®¢æˆ·ç«¯ã€è½¬æ¢å‡½æ•°å¯å¤ç”¨
4. **å›¢é˜Ÿåä½œ**: ä¸åŒå±‚å¯ä»¥å¹¶è¡Œå¼€å‘

å®é™…æ¡ˆä¾‹ï¼šæˆ‘ä»¬é¡¹ç›®ä»æ—§é‡åŒ–ç³»ç»Ÿè¿ç§»åˆ°CZSCç³»ç»Ÿï¼Œå› ä¸ºæœ‰è½¬æ¢å±‚ï¼ŒUIå±‚ä»£ç å®Œå…¨ä¸éœ€è¦ä¿®æ”¹ï¼Œåªæ”¹äº†APIæœåŠ¡å±‚å’Œè½¬æ¢å±‚ã€‚"

**Q: å¦‚æœåç«¯APIæ ¼å¼å†æ¬¡å˜åŒ–æ€ä¹ˆåŠï¼Ÿ**

A: "æˆ‘ä»¬çš„æ¶æ„å·²ç»è€ƒè™‘åˆ°è¿™ä¸ªé—®é¢˜ï¼š
1. åªéœ€ä¿®æ”¹è½¬æ¢å‡½æ•°ï¼Œæ·»åŠ æ–°çš„æ˜ å°„é€»è¾‘
2. å¯ä»¥åŒæ—¶æ”¯æŒæ—§ç‰ˆå’Œæ–°ç‰ˆAPIï¼Œæ¸è¿›å¼è¿ç§»
3. APIæœåŠ¡å±‚æä¾›çš„æ˜¯ä¸šåŠ¡æ¥å£ï¼Œå†…éƒ¨å®ç°å¯ä»¥éšæ„åˆ‡æ¢

ä¾‹å¦‚`getStrategies()`æ–¹æ³•ï¼Œç°åœ¨è°ƒç”¨CZSC APIï¼Œä»¥åæ¢æˆGraphQLæˆ–gRPCï¼Œåªéœ€æ”¹è¿™ä¸ªæ–¹æ³•å†…éƒ¨å®ç°ï¼Œè°ƒç”¨æ–¹å®Œå…¨æ— æ„ŸçŸ¥ã€‚"

**Q: æ•°æ®è½¬æ¢å±‚çš„æ€§èƒ½å¼€é”€å¤§å—ï¼Ÿ**

A: "è½¬æ¢å±‚çš„æ€§èƒ½å¼€é”€éå¸¸å°ï¼š
1. ä¸»è¦æ˜¯å¯¹è±¡å­—æ®µæ˜ å°„ï¼Œæ—¶é—´å¤æ‚åº¦O(n)
2. åªåœ¨APIè°ƒç”¨æ—¶è½¬æ¢ï¼Œä¸æ˜¯å®æ—¶è½¬æ¢
3. è½¬æ¢åçš„æ•°æ®ä¼šç¼“å­˜åœ¨çŠ¶æ€ä¸­
4. ç½‘ç»œIOæ—¶é—´è¿œå¤§äºè½¬æ¢æ—¶é—´

å®æµ‹ï¼šè½¬æ¢1000æ¡ç­–ç•¥æ•°æ® < 10msï¼ŒAPIè¯·æ±‚é€šå¸¸éœ€è¦100-500msã€‚"

**Q: ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨åç«¯è¿”å›çš„æ•°æ®æ ¼å¼ï¼Ÿ**

A: "ç›´æ¥ä½¿ç”¨åç«¯æ ¼å¼ä¼šå¯¼è‡´ï¼š
1. å‰ç«¯é€»è¾‘è¢«åç«¯ç»‘æ¶
2. åç«¯å­—æ®µåå˜åŒ–ï¼Œæ‰€æœ‰UIç»„ä»¶éƒ½è¦æ”¹
3. è¯­ä¹‰ä¸æ¸…æ™°ï¼ˆ`is_active` vs `enabled`ï¼‰
4. ç±»å‹ä¸åŒ¹é…ï¼ˆå­—ç¬¦ä¸²ID vs æ•°å­—IDï¼‰

å¼•å…¥è½¬æ¢å±‚åï¼Œå‰ç«¯å¯ä»¥å®šä¹‰æœ€é€‚åˆè‡ªå·±çš„æ•°æ®æ ¼å¼ï¼Œä¸åç«¯è§£è€¦ã€‚"

---

### 22. å¦‚ä½•ä¿è¯ç±»å‹å®‰å…¨å’Œæ•°æ®ä¸€è‡´æ€§ï¼Ÿ

#### è¯„åˆ†è¦ç‚¹ï¼š
- å…¨é“¾è·¯TypeScriptç±»å‹å®šä¹‰
- è¿è¡Œæ—¶æ•°æ®æ ¡éªŒï¼ˆzod/yupï¼‰
- æ¥å£å¥‘çº¦ï¼ˆOpenAPIï¼‰
- å•å…ƒæµ‹è¯•è¦†ç›–è½¬æ¢é€»è¾‘

#### å‚è€ƒç­”æ¡ˆè¦ç‚¹ï¼š

```typescript
// 1. ä¸¥æ ¼çš„ç±»å‹å®šä¹‰
interface CZSCStrategy {
  strategy_id: string;
  name: string;
  is_active: boolean;
  // ...
}

interface StrategyConfig {
  id: number;
  name: string;
  enabled: boolean;
  // ...
}

// 2. è½¬æ¢å‡½æ•°çš„ç±»å‹çº¦æŸ
const convertFromCZSCStrategy = (
  czsc: CZSCStrategy  // è¾“å…¥ç±»å‹æ˜ç¡®
): StrategyConfig => {  // è¾“å‡ºç±»å‹æ˜ç¡®
  return {
    id: parseInt(czsc.strategy_id.replace(/\D/g, '')),
    name: czsc.name,
    enabled: czsc.is_active,
    // TypeScriptä¼šæ£€æŸ¥æ‰€æœ‰å¿…éœ€å­—æ®µæ˜¯å¦å­˜åœ¨
  };
};

// 3. APIæœåŠ¡å±‚çš„ç±»å‹çº¦æŸ
export const strategyAPI = {
  getStrategies: async (): Promise<StrategyConfig[]> => {
    // è¿”å›ç±»å‹æ˜ç¡®ï¼Œç¼–è¯‘æ—¶æ£€æŸ¥
  }
};

// 4. è¿è¡Œæ—¶æ ¡éªŒï¼ˆå¯é€‰ï¼Œç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰
import { z } from 'zod';

const CZSCStrategySchema = z.object({
  strategy_id: z.string(),
  name: z.string(),
  is_active: z.boolean(),
  // ...
});

// åœ¨å“åº”æ‹¦æˆªå™¨ä¸­æ ¡éªŒ
const validated = CZSCStrategySchema.parse(response.data);
```

**å¥½å¤„**ï¼š
- âœ… ç¼–è¯‘æ—¶å‘ç°ç±»å‹é”™è¯¯
- âœ… IDEè‡ªåŠ¨è¡¥å…¨å’Œæç¤º
- âœ… é‡æ„å®‰å…¨ï¼ˆä¿®æ”¹ç±»å‹å®šä¹‰ï¼Œæ‰€æœ‰ä½¿ç”¨çš„åœ°æ–¹éƒ½ä¼šæŠ¥é”™ï¼‰
- âœ… å‡å°‘è¿è¡Œæ—¶é”™è¯¯

---

## é™„å½•
- å»ºè®®è¯„åˆ†æƒé‡ï¼šæŠ€æœ¯æ·±åº¦ 50%ã€å·¥ç¨‹å®è·µ 30%ã€æ²Ÿé€šä¸åä½œ 20%
- å»ºè®®è¡¥å……ææ–™ï¼šå…³é”®æ–‡ä»¶è·¯å¾„ï¼ˆ`src/pages/KlineChart.tsx`, `src/App.tsx`, `src/hooks/*`, `src/services/*`, `src/components/charts/*`ï¼‰ä»¥ä¾¿é¢è¯•æ—¶å¿«é€Ÿå¼•ç”¨
- **æ ¸å¿ƒçŸ¥è¯†ç‚¹**ï¼šç¬¬21é¢˜ï¼ˆæ¥å£æ•°æ®å¤„ç†æ¶æ„ï¼‰æ˜¯æœ€é‡è¦çš„é¢è¯•é—®é¢˜ï¼Œå»ºè®®é‡ç‚¹å‡†å¤‡


---

æ–‡æ¡£ç”Ÿæˆäºä»“åº“ `trading-master-front`ã€‚æ¥å£æ•°æ®å¤„ç†æ¶æ„ç« èŠ‚ç”±Claude CodeååŠ©æ•´ç†ã€‚
