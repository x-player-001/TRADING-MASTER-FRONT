# Position ç­–ç•¥åˆ›å»ºæŒ‡å—

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜å¦‚ä½•åˆ›å»ºå’Œä½¿ç”¨ CZSC Position ç­–ç•¥ã€‚

---

## ç›®å½•

1. [åŸºæœ¬æ¦‚å¿µ](#åŸºæœ¬æ¦‚å¿µ)
2. [ç­–ç•¥ç»“æ„](#ç­–ç•¥ç»“æ„)
3. [åˆ›å»ºæ­¥éª¤](#åˆ›å»ºæ­¥éª¤)
4. [å®Œæ•´ç¤ºä¾‹](#å®Œæ•´ç¤ºä¾‹)
5. [ä¿¡å·å‡½æ•°å‚è€ƒ](#ä¿¡å·å‡½æ•°å‚è€ƒ)
6. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## åŸºæœ¬æ¦‚å¿µ

### Position ç­–ç•¥çš„å››å±‚æ¶æ„

```
Signal (ä¿¡å·)
    â†“
Factor (å› å­) = Signal çš„é€»è¾‘ç»„åˆ
    â†“
Event (äº‹ä»¶) = Factor çš„é›†åˆï¼ˆä»»ä¸€æ»¡è¶³å³è§¦å‘ï¼‰
    â†“
Position (ç­–ç•¥) = Opens + Exits + é£æ§å‚æ•°
```

### æ ¸å¿ƒç»„ä»¶

1. **Signalï¼ˆä¿¡å·ï¼‰**
   - æœ€åº•å±‚çš„æŠ€æœ¯æŒ‡æ ‡å’Œå¸‚åœºçŠ¶æ€
   - ç”± CZSC ä¿¡å·å‡½æ•°è‡ªåŠ¨ç”Ÿæˆ
   - ä¾‹å¦‚ï¼šç¬”æ–¹å‘ã€ä¹°å–ç‚¹ã€MACDã€æˆäº¤é‡ç­‰

2. **Factorï¼ˆå› å­ï¼‰**
   - å¤šä¸ªä¿¡å·çš„é€»è¾‘ç»„åˆ
   - æ”¯æŒ ANDã€ORã€NOT ä¸‰ç§é€»è¾‘
   - ä¾‹å¦‚ï¼šMACDé‡‘å‰ AND ç¬”å‘ä¸Š AND æˆäº¤é‡æœªç¼©é‡

3. **Eventï¼ˆäº‹ä»¶ï¼‰**
   - å¼€ä»“äº‹ä»¶ï¼ˆOpensï¼‰æˆ–å¹³ä»“äº‹ä»¶ï¼ˆExitsï¼‰
   - åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª Factor
   - ä»»ä¸€ Factor æ»¡è¶³å³è§¦å‘äº‹ä»¶

4. **Positionï¼ˆç­–ç•¥ï¼‰**
   - å®Œæ•´çš„äº¤æ˜“ç­–ç•¥
   - åŒ…å«å¼€ä»“äº‹ä»¶ã€å¹³ä»“äº‹ä»¶ã€é£æ§å‚æ•°

---

## ç­–ç•¥ç»“æ„

### å®Œæ•´çš„ç­–ç•¥ JSON ç»“æ„

```json
{
  "strategy_id": "ç­–ç•¥å”¯ä¸€æ ‡è¯†",
  "name": "ç­–ç•¥åç§°",
  "description": "ç­–ç•¥æè¿°",
  "category": "ç­–ç•¥ç±»åˆ«",

  "positions_config": [
    {
      "name": "æŒä»“ç­–ç•¥åç§°",
      "symbol": "äº¤æ˜“æ ‡çš„",

      "opens": [
        {
          "operate": "æ“ä½œç±»å‹",
          "factors": [
            {
              "name": "å› å­åç§°",
              "signals_all": ["å¿…é¡»åŒæ—¶æ»¡è¶³çš„ä¿¡å·åˆ—è¡¨"],
        "signals_any": ["æ»¡è¶³ä»»ä¸€å³å¯çš„ä¿¡å·åˆ—è¡¨"],
        "signals_not": ["ä¸èƒ½å‡ºç°çš„ä¿¡å·åˆ—è¡¨"]
            }
          ]
        }
      ],

      "exits": [
        {
          "operate": "æ“ä½œç±»å‹",
          "factors": [...]
        }
      ],

      "interval": 0,
      "timeout": 100,
      "stop_loss": 200,
      "T0": false
    }
  ],

  "signals_config": [
    {
      "name": "ä¿¡å·å‡½æ•°å",
      "freq": "å‘¨æœŸ",
      "å‚æ•°å": "å‚æ•°å€¼"
    }
  ],

  "ensemble_method": "mean",
  "fee_rate": 0.001,
  "digits": 2,
  "version": "1.0.0",
  "author": "ä½œè€…",
  "tags": ["æ ‡ç­¾1", "æ ‡ç­¾2"]
}
```

### å­—æ®µè¯´æ˜

#### åŸºæœ¬ä¿¡æ¯
- `strategy_id`: ç­–ç•¥å”¯ä¸€IDï¼Œåˆ›å»ºåä¸å¯ä¿®æ”¹
- `name`: ç­–ç•¥åç§°ï¼Œä¾¿äºè¯†åˆ«
- `description`: è¯¦ç»†æè¿°ç­–ç•¥é€»è¾‘
- `category`: ç±»åˆ«ï¼ˆtrend/reversal/arbitrage/multi_factorï¼‰
- `tags`: æ ‡ç­¾æ•°ç»„ï¼Œä¾¿äºåˆ†ç±»å’Œæœç´¢

#### Position é…ç½®
- `name`: æŒä»“ç­–ç•¥åç§°
- `symbol`: äº¤æ˜“æ ‡çš„ä»£ç ï¼ˆå¯åœ¨å›æµ‹æ—¶è¦†ç›–ï¼‰

#### æ“ä½œç±»å‹ï¼ˆoperateï¼‰
- `LO`: Long Open - å¼€å¤šä»“
- `LE`: Long Exit - å¹³å¤šä»“
- `SO`: Short Open - å¼€ç©ºä»“
- `SE`: Short Exit - å¹³ç©ºä»“

#### Factor é€»è¾‘

**âš ï¸ é‡è¦ï¼šFactor å¿…é¡»åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªå­—æ®µï¼ˆå³ä½¿ä¸ºç©ºæ•°ç»„ï¼‰**

```json
{
  "name": "å› å­åç§°",
  "signals_all": [],  // å¿…å¡«ï¼šæ‰€æœ‰ä¿¡å·å¿…é¡»åŒæ—¶æ»¡è¶³ï¼ˆAND é€»è¾‘ï¼‰
  "signals_any": [],  // å¿…å¡«ï¼šä»»æ„ä¿¡å·æ»¡è¶³å³å¯ï¼ˆOR é€»è¾‘ï¼‰
  "signals_not": []   // å¿…å¡«ï¼šä¸èƒ½å‡ºç°çš„ä¿¡å·ï¼ˆNOT é€»è¾‘ï¼‰
}
```

**å­—æ®µè¯´æ˜**ï¼š
- `signals_all`: æ‰€æœ‰ä¿¡å·å¿…é¡»åŒæ—¶æ»¡è¶³ï¼ˆAND é€»è¾‘ï¼‰**âš ï¸ ä¸èƒ½ä¸ºç©ºæ•°ç»„ï¼Œè‡³å°‘éœ€è¦1ä¸ªä¿¡å·**
- `signals_any`: ä»»æ„ä¿¡å·æ»¡è¶³å³å¯ï¼ˆOR é€»è¾‘ï¼‰ï¼Œå¯ä»¥ä¸ºç©ºæ•°ç»„
- `signals_not`: ä¸èƒ½å‡ºç°çš„ä¿¡å·ï¼ˆNOT é€»è¾‘ï¼‰ï¼Œå¯ä»¥ä¸ºç©ºæ•°ç»„
- ä¸‰ä¸ªå­—æ®µ**å¿…é¡»å…¨éƒ¨å­˜åœ¨**
- **å…³é”®é™åˆ¶**ï¼š`signals_all` å¿…é¡»è‡³å°‘åŒ…å«ä¸€ä¸ªä¿¡å·ï¼Œå¦åˆ™ä¼šæŠ¥é”™ "signals_all ä¸èƒ½ä¸ºç©º"

**å®ç° OR é€»è¾‘çš„æ­£ç¡®æ–¹å¼**ï¼š
å¦‚æœéœ€è¦"ä»»ä¸€ä¹°ç‚¹è§¦å‘"ï¼ˆOR é€»è¾‘ï¼‰ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š
1. **æ¨è**ï¼šåœ¨ Event ä¸­åˆ›å»ºå¤šä¸ª Factorï¼Œæ¯ä¸ª Factor åªåŒ…å«ä¸€ä¸ªä¿¡å·
2. **ä¸æ¨è**ï¼šå•ä¸ª Factor ä¸­æŠŠå¤šä¸ªä¿¡å·æ”¾åˆ° `signals_all`ï¼ˆè¿™å˜æˆäº† AND é€»è¾‘ï¼‰

#### é£æ§å‚æ•°
- `interval`: å¼€ä»“é—´éš”ï¼ˆKçº¿æ•°ï¼‰ï¼Œ0è¡¨ç¤ºæ— é™åˆ¶
- `timeout`: æŒä»“è¶…æ—¶ï¼ˆKçº¿æ•°ï¼‰ï¼Œè¶…æ—¶è‡ªåŠ¨å¹³ä»“
- `stop_loss`: æ­¢æŸï¼ˆBPï¼‰ï¼Œ1BP=0.01%ï¼Œ200è¡¨ç¤º2%
- `T0`: æ˜¯å¦æ”¯æŒT+0äº¤æ˜“

#### å›æµ‹å‚æ•°
- `ensemble_method`: å¤šç­–ç•¥é›†æˆæ–¹æ³•ï¼ˆmean/vote/maxï¼‰
- `fee_rate`: æ‰‹ç»­è´¹ç‡ï¼ˆå•è¾¹ï¼‰
- `digits`: æƒé‡å°æ•°ä½æ•°

---

## åˆ›å»ºæ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šç¡®å®šäº¤æ˜“é€»è¾‘

å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š
1. **åšå¤šè¿˜æ˜¯åšç©ºï¼Ÿ** å•å‘æˆ–åŒå‘ï¼Ÿ
2. **å¼€ä»“æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ** éœ€è¦å“ªäº›ä¿¡å·ï¼Ÿ
3. **å¹³ä»“æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ** æ­¢ç›ˆã€æ­¢æŸã€è¶…æ—¶ï¼Ÿ
4. **é£æ§å¦‚ä½•è®¾ç½®ï¼Ÿ** æ­¢æŸå¤šå°‘ï¼Ÿå¤šä¹…è¶…æ—¶ï¼Ÿ

### ç¬¬äºŒæ­¥ï¼šé€‰æ‹©ä¿¡å·å‡½æ•°

æ ¹æ®äº¤æ˜“é€»è¾‘é€‰æ‹©éœ€è¦çš„ä¿¡å·å‡½æ•°ï¼š

| ç­–ç•¥ç±»å‹ | æ¨èä¿¡å·å‡½æ•° |
|---------|-------------|
| ç¬”æ–¹å‘ç­–ç•¥ | `cxt_bi_base_V230228` |
| ä¹°å–ç‚¹ç­–ç•¥ | `cxt_first_bs_V230228`<br>`cxt_second_bs_V230228`<br>`cxt_third_bs_V230318` |
| MACDç­–ç•¥ | `bar_macd_V230101` |
| è¶‹åŠ¿ç­–ç•¥ | `bar_sma_V230101`<br>`trend_strength_V230101` |
| æˆäº¤é‡ç­–ç•¥ | `vol_ma_V230101` |

å®Œæ•´ä¿¡å·åˆ—è¡¨ï¼š
```bash
GET /api/v1/signals/list
```

### ç¬¬ä¸‰æ­¥ï¼šæ„å»ºç­–ç•¥é…ç½®

æ ¹æ®æ¨¡æ¿å¡«å†™é…ç½®ï¼Œå‚è€ƒ[å®Œæ•´ç¤ºä¾‹](#å®Œæ•´ç¤ºä¾‹)ã€‚

### ç¬¬å››æ­¥ï¼šè°ƒç”¨ API åˆ›å»º

```bash
POST /api/v1/strategy
Content-Type: application/json

{ç­–ç•¥é…ç½®}
```

### ç¬¬äº”æ­¥ï¼šå›æµ‹éªŒè¯

```bash
POST /api/v1/backtest/czsc
{
  "symbol": "BTCUSDT",
  "freq": "15m",
  "start_date": "2025-09-01T00:00:00",
  "end_date": "2025-10-01T00:00:00",
  "strategy_id": "your_strategy_id"
}
```

---

## å®Œæ•´ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šç¬”æ–¹å‘çº¯å¤šå¤´ç­–ç•¥

**ç­–ç•¥é€»è¾‘**ï¼šç¬”å‘ä¸Šå¼€å¤šï¼Œç¬”å‘ä¸‹å¹³å¤š

```json
{
  "strategy_id": "bi_direction_long_only_v1",
  "name": "ç¬”æ–¹å‘çº¯å¤šå¤´ç­–ç•¥",
  "description": "ç¬”å‘ä¸Šæ—¶å¼€å¤šä»“ï¼Œç¬”å‘ä¸‹æ—¶å¹³ä»“",
  "category": "trend",

  "positions_config": [{
    "name": "ç¬”æ–¹å‘å¤šå¤´",
    "symbol": "BTCUSDT",

    "opens": [{
      "operate": "LO",
      "factors": [{
        "name": "ç¬”å‘ä¸Š",
        "signals_all": ["15m_D0BL9_V230228_å‘ä¸Š_ä»»æ„_ä»»æ„_ä»»æ„_0"],
        "signals_any": [],
        "signals_not": []
      }]
    }],

    "exits": [{
      "operate": "LE",
      "factors": [{
        "name": "ç¬”å‘ä¸‹",
        "signals_all": ["15m_D0BL9_V230228_å‘ä¸‹_ä»»æ„_ä»»æ„_ä»»æ„_0"],
        "signals_any": [],
        "signals_not": []
      }]
    }],

    "interval": 10,
    "timeout": 100,
    "stop_loss": 200,
    "T0": false
  }],

  "signals_config": [{
    "name": "czsc.signals.cxt.cxt_bi_base_V230228",
    "freq": "15m",
    "bi_init_length": 9
  }],

  "ensemble_method": "mean",
  "fee_rate": 0.001,
  "version": "1.0.0",
  "author": "Your Name",
  "tags": ["trend", "bi_direction", "long_only"]
}
```

### ç¤ºä¾‹2ï¼šç¬”æ–¹å‘å¤šç©ºåŒå‘ç­–ç•¥

**ç­–ç•¥é€»è¾‘**ï¼šç¬”å‘ä¸Šå¼€å¤šå¹³ç©ºï¼Œç¬”å‘ä¸‹å¼€ç©ºå¹³å¤š

```json
{
  "strategy_id": "bi_direction_bidirection_v1",
  "name": "ç¬”æ–¹å‘å¤šç©ºåŒå‘ç­–ç•¥",
  "description": "ç¬”å‘ä¸Šåšå¤šï¼Œç¬”å‘ä¸‹åšç©º",
  "category": "trend",

  "positions_config": [{
    "name": "ç¬”æ–¹å‘åŒå‘",
    "symbol": "BTCUSDT",

    "opens": [
      {
        "operate": "LO",
        "factors": [{
          "name": "ç¬”å‘ä¸Šå¼€å¤š",
          "signals_all": ["15m_D0BL9_V230228_å‘ä¸Š_ä»»æ„_ä»»æ„_ä»»æ„_0"],
        "signals_any": [],
        "signals_not": []
      }]
      },
      {
        "operate": "SO",
        "factors": [{
          "name": "ç¬”å‘ä¸‹å¼€ç©º",
          "signals_all": ["15m_D0BL9_V230228_å‘ä¸‹_ä»»æ„_ä»»æ„_ä»»æ„_0"],
        "signals_any": [],
        "signals_not": []
      }]
      }
    ],

    "exits": [
      {
        "operate": "LE",
        "factors": [{
          "name": "ç¬”å‘ä¸‹å¹³å¤š",
          "signals_all": ["15m_D0BL9_V230228_å‘ä¸‹_ä»»æ„_ä»»æ„_ä»»æ„_0"],
        "signals_any": [],
        "signals_not": []
      }]
      },
      {
        "operate": "SE",
        "factors": [{
          "name": "ç¬”å‘ä¸Šå¹³ç©º",
          "signals_all": ["15m_D0BL9_V230228_å‘ä¸Š_ä»»æ„_ä»»æ„_ä»»æ„_0"],
        "signals_any": [],
        "signals_not": []
      }]
      }
    ],

    "interval": 5,
    "timeout": 100,
    "stop_loss": 200,
    "T0": false
  }],

  "signals_config": [{
    "name": "czsc.signals.cxt.cxt_bi_base_V230228",
    "freq": "15m",
    "bi_init_length": 9
  }],

  "ensemble_method": "mean",
  "fee_rate": 0.001,
  "version": "1.0.0",
  "author": "Your Name",
  "tags": ["trend", "bi_direction", "bidirection"]
}
```

### ç¤ºä¾‹3ï¼šç¼ è®ºä¹°å–ç‚¹ç­–ç•¥

**ç­–ç•¥é€»è¾‘**ï¼šä»»ä¸€ä¹°ç‚¹å¼€å¤šï¼Œä»»ä¸€å–ç‚¹å¹³å¤š

**è¯´æ˜**ï¼šå®ç° OR é€»è¾‘ï¼ˆä»»ä¸€ä¹°ç‚¹ï¼‰çš„æ­£ç¡®æ–¹å¼æ˜¯ä½¿ç”¨å¤šä¸ª Factorï¼Œæ¯ä¸ª Factor åŒ…å«ä¸€ä¸ªä¿¡å·ã€‚Event ä¼šåœ¨ä»»ä¸€ Factor æ»¡è¶³æ—¶è§¦å‘ã€‚

```json
{
  "strategy_id": "czsc_buypoint_v1",
  "name": "ç¼ è®ºä¹°å–ç‚¹ç­–ç•¥",
  "description": "ä¸€ä¹°äºŒä¹°ä¸‰ä¹°å¼€å¤šï¼Œä¸€å–äºŒå–ä¸‰å–å¹³å¤š",
  "category": "trend",

  "positions_config": [{
    "name": "ä¹°å–ç‚¹ç­–ç•¥",
    "symbol": "BTCUSDT",

    "opens": [{
      "operate": "LO",
      "factors": [
        {
          "name": "ä¸€ä¹°",
          "signals_all": ["15m_D1BS_ä¸€ä¹°_ä»»æ„_ä»»æ„_ä»»æ„_0"],
          "signals_any": [],
          "signals_not": []
        },
        {
          "name": "äºŒä¹°",
          "signals_all": ["15m_D2BS_äºŒä¹°_ä»»æ„_ä»»æ„_ä»»æ„_0"],
          "signals_any": [],
          "signals_not": []
        },
        {
          "name": "ä¸‰ä¹°",
          "signals_all": ["15m_D3BS_ä¸‰ä¹°_ä»»æ„_ä»»æ„_ä»»æ„_0"],
          "signals_any": [],
          "signals_not": []
        }
      ]
    }],

    "exits": [{
      "operate": "LE",
      "factors": [
        {
          "name": "ä¸€å–",
          "signals_all": ["15m_D1SS_ä¸€å–_ä»»æ„_ä»»æ„_ä»»æ„_0"],
          "signals_any": [],
          "signals_not": []
        },
        {
          "name": "äºŒå–",
          "signals_all": ["15m_D2SS_äºŒå–_ä»»æ„_ä»»æ„_ä»»æ„_0"],
          "signals_any": [],
          "signals_not": []
        },
        {
          "name": "ä¸‰å–",
          "signals_all": ["15m_D3SS_ä¸‰å–_ä»»æ„_ä»»æ„_ä»»æ„_0"],
          "signals_any": [],
          "signals_not": []
        }
      ]
    }],

    "interval": 20,
    "timeout": 150,
    "stop_loss": 300,
    "T0": false
  }],

  "signals_config": [
    {
      "name": "czsc.signals.cxt.cxt_first_bs_V230228",
      "freq": "15m"
    },
    {
      "name": "czsc.signals.cxt.cxt_second_bs_V230228",
      "freq": "15m"
    },
    {
      "name": "czsc.signals.cxt.cxt_third_bs_V230318",
      "freq": "15m"
    }
  ],

  "ensemble_method": "mean",
  "fee_rate": 0.001,
  "version": "1.0.0",
  "author": "Your Name",
  "tags": ["buypoint", "trend", "long_only"]
}
```

### ç¤ºä¾‹4ï¼šå¤šå› å­ç»„åˆç­–ç•¥

**ç­–ç•¥é€»è¾‘**ï¼šç¬”å‘ä¸Š AND MACDé‡‘å‰ AND æˆäº¤é‡ä¸ç¼©é‡ â†’ å¼€å¤š

```json
{
  "strategy_id": "multi_factor_v1",
  "name": "å¤šå› å­ç»„åˆç­–ç•¥",
  "description": "ç¬”å‘ä¸Šã€MACDé‡‘å‰ã€æˆäº¤é‡æ”¾å¤§ä¸‰é‡ç¡®è®¤",
  "category": "multi_factor",

  "positions_config": [{
    "name": "ä¸‰é‡ç¡®è®¤",
    "symbol": "BTCUSDT",

    "opens": [{
      "operate": "LO",
      "factors": [{
        "name": "ä¸‰é‡ç¡®è®¤å¼€å¤š",
        "signals_all": [
          "15m_D0BL9_V230228_å‘ä¸Š_ä»»æ„_ä»»æ„_ä»»æ„_0",
          "15m_MACD_é‡‘å‰_ä»»æ„_ä»»æ„_ä»»æ„_0"
        ],
        "signals_not": [
          "15m_VOL_ç¼©é‡_ä»»æ„_ä»»æ„_ä»»æ„_0"
        ]
      }]
    }],

    "exits": [
      {
        "operate": "LE",
        "factors": [
          {
            "name": "ç¬”è½¬å‘",
            "signals_all": ["15m_D0BL9_V230228_å‘ä¸‹_ä»»æ„_ä»»æ„_ä»»æ„_0"],
        "signals_any": [],
        "signals_not": []
      },
          {
            "name": "MACDæ­»å‰",
            "signals_all": ["15m_MACD_æ­»å‰_ä»»æ„_ä»»æ„_ä»»æ„_0"],
        "signals_any": [],
        "signals_not": []
      }
        ]
      }
    ],

    "interval": 15,
    "timeout": 80,
    "stop_loss": 200,
    "T0": false
  }],

  "signals_config": [
    {
      "name": "czsc.signals.cxt.cxt_bi_base_V230228",
      "freq": "15m"
    },
    {
      "name": "czsc.signals.bar.bar_macd_V230101",
      "freq": "15m",
      "fast": 12,
      "slow": 26,
      "signal": 9
    },
    {
      "name": "czsc.signals.vol.vol_ma_V230101",
      "freq": "15m",
      "timeperiod": 20
    }
  ],

  "ensemble_method": "mean",
  "fee_rate": 0.001,
  "version": "1.0.0",
  "author": "Your Name",
  "tags": ["multi_factor", "trend", "confirmation"]
}
```

### ç¤ºä¾‹5ï¼šå¤šçº§åˆ«è”ç«‹ç­–ç•¥

**ç­–ç•¥é€»è¾‘**ï¼šå¤§å‘¨æœŸè¶‹åŠ¿å‘ä¸Š + å°å‘¨æœŸä¹°ç‚¹ â†’ å¼€å¤š

```json
{
  "strategy_id": "multi_timeframe_v1",
  "name": "å¤šçº§åˆ«è”ç«‹ç­–ç•¥",
  "description": "æ—¥çº¿ç¬”å‘ä¸Šï¼Œ15åˆ†é’Ÿä¸‰ä¹°å¼€å¤š",
  "category": "trend",

  "positions_config": [{
    "name": "å¤§å°å‘¨æœŸå…±æŒ¯",
    "symbol": "BTCUSDT",

    "opens": [{
      "operate": "LO",
      "factors": [{
        "name": "å¤§å°å‘¨æœŸå…±æŒ¯",
        "signals_all": [
          "1d_D0BL9_V230228_å‘ä¸Š_ä»»æ„_ä»»æ„_ä»»æ„_0",
          "15m_D3BS_ä¸‰ä¹°_ä»»æ„_ä»»æ„_ä»»æ„_0"
        ],
        "signals_any": [],
        "signals_not": []
      }]
    }],

    "exits": [{
      "operate": "LE",
      "factors": [{
        "name": "ä¸‰å–æˆ–æ—¥çº¿è½¬å‘",
        "signals_all": [],
        "signals_any": [
          "15m_D3SS_ä¸‰å–_ä»»æ„_ä»»æ„_ä»»æ„_0",
          "1d_D0BL9_V230228_å‘ä¸‹_ä»»æ„_ä»»æ„_ä»»æ„_0"
        ],
        "signals_not": []
      }]
    }],

    "interval": 30,
    "timeout": 200,
    "stop_loss": 300,
    "T0": false
  }],

  "signals_config": [
    {
      "name": "czsc.signals.cxt.cxt_bi_base_V230228",
      "freq": "1d"
    },
    {
      "name": "czsc.signals.cxt.cxt_third_bs_V230318",
      "freq": "15m"
    }
  ],

  "ensemble_method": "mean",
  "fee_rate": 0.001,
  "version": "1.0.0",
  "author": "Your Name",
  "tags": ["multi_timeframe", "trend", "resonance"]
}
```

---

## ä¿¡å·å‡½æ•°å‚è€ƒ

### å¸¸ç”¨ä¿¡å·å‡½æ•°

#### 1. ç¬”ç›¸å…³
```json
{
  "name": "czsc.signals.cxt.cxt_bi_base_V230228",
  "freq": "15m",
  "bi_init_length": 9
}
```
**ç”Ÿæˆä¿¡å·**ï¼š
- `15m_D0BL9_V230228_å‘ä¸Š_ä»»æ„_ä»»æ„_ä»»æ„_0`
- `15m_D0BL9_V230228_å‘ä¸‹_ä»»æ„_ä»»æ„_ä»»æ„_0`

#### 2. ä¹°å–ç‚¹
```json
{
  "name": "czsc.signals.cxt.cxt_first_bs_V230228",
  "freq": "15m"
}
```
**ç”Ÿæˆä¿¡å·**ï¼š
- `15m_D1BS_ä¸€ä¹°_ä»»æ„_ä»»æ„_ä»»æ„_0`
- `15m_D1SS_ä¸€å–_ä»»æ„_ä»»æ„_ä»»æ„_0`

```json
{
  "name": "czsc.signals.cxt.cxt_second_bs_V230228",
  "freq": "15m"
}
```
**ç”Ÿæˆä¿¡å·**ï¼š
- `15m_D2BS_äºŒä¹°_ä»»æ„_ä»»æ„_ä»»æ„_0`
- `15m_D2SS_äºŒå–_ä»»æ„_ä»»æ„_ä»»æ„_0`

```json
{
  "name": "czsc.signals.cxt.cxt_third_bs_V230318",
  "freq": "15m"
}
```
**ç”Ÿæˆä¿¡å·**ï¼š
- `15m_D3BS_ä¸‰ä¹°_ä»»æ„_ä»»æ„_ä»»æ„_0`
- `15m_D3SS_ä¸‰å–_ä»»æ„_ä»»æ„_ä»»æ„_0`

#### 3. MACD
```json
{
  "name": "czsc.signals.bar.bar_macd_V230101",
  "freq": "15m",
  "fast": 12,
  "slow": 26,
  "signal": 9
}
```
**ç”Ÿæˆä¿¡å·**ï¼š
- `15m_MACD_é‡‘å‰_ä»»æ„_ä»»æ„_ä»»æ„_0`
- `15m_MACD_æ­»å‰_ä»»æ„_ä»»æ„_ä»»æ„_0`

#### 4. æˆäº¤é‡
```json
{
  "name": "czsc.signals.vol.vol_ma_V230101",
  "freq": "15m",
  "timeperiod": 20
}
```
**ç”Ÿæˆä¿¡å·**ï¼š
- `15m_VOL_æ”¾é‡_ä»»æ„_ä»»æ„_ä»»æ„_0`
- `15m_VOL_ç¼©é‡_ä»»æ„_ä»»æ„_ä»»æ„_0`

### è·å–å®Œæ•´ä¿¡å·åˆ—è¡¨

```bash
GET /api/v1/signals/list
```

---

## æœ€ä½³å®è·µ

### 1. ç­–ç•¥å‘½åè§„èŒƒ

**strategy_id å»ºè®®æ ¼å¼**ï¼š
```
{ç­–ç•¥ç±»å‹}_{ç‰ˆæœ¬å·}_v{æ•°å­—}
```

ç¤ºä¾‹ï¼š
- `bi_direction_long_v1`
- `buypoint_aggressive_v2`
- `multi_factor_macd_v1`

**name å»ºè®®**ï¼š
- ç®€æ´æ˜äº†ï¼Œèƒ½ä½“ç°ç­–ç•¥æ ¸å¿ƒé€»è¾‘
- ä¾‹å¦‚ï¼š"ç¬”æ–¹å‘çº¯å¤šå¤´ç­–ç•¥"ã€"ä¸‰ä¹°ä¸‰å–ä¿å®ˆç­–ç•¥"

### 2. é£æ§å‚æ•°å»ºè®®

| å‘¨æœŸ | interval | timeout | stop_loss |
|------|----------|---------|-----------|
| 1åˆ†é’Ÿ | 5-10 | 30-50 | 150-200 |
| 5åˆ†é’Ÿ | 5-10 | 50-80 | 150-200 |
| 15åˆ†é’Ÿ | 10-20 | 80-120 | 200-300 |
| 60åˆ†é’Ÿ | 10-20 | 100-150 | 300-500 |
| æ—¥çº¿ | 3-5 | 20-30 | 500-1000 |

**è¯´æ˜**ï¼š
- **interval**ï¼šé¿å…é¢‘ç¹äº¤æ˜“ï¼Œé™ä½æ‰‹ç»­è´¹
- **timeout**ï¼šç»™è¶‹åŠ¿è¶³å¤Ÿå‘å±•æ—¶é—´ï¼Œä½†ä¸èƒ½å¤ªé•¿
- **stop_loss**ï¼šæ ¹æ®æ³¢åŠ¨ç‡è°ƒæ•´ï¼Œæ—¥çº¿å¯ä»¥è®¾æ›´å¤§

### 3. Factor è®¾è®¡åŸåˆ™

**å¥½çš„ Factor**ï¼š
```json
{
  "name": "å¼ºåŠ¿çªç ´",
  "signals_all": [
    "15m_D0BL9_V230228_å‘ä¸Š_ä»»æ„_ä»»æ„_ä»»æ„_0",
    "15m_MACD_é‡‘å‰_ä»»æ„_ä»»æ„_ä»»æ„_0"
  ],
        "signals_not": [
    "15m_VOL_ç¼©é‡_ä»»æ„_ä»»æ„_ä»»æ„_0"
  ]
}
```

**é¿å…è¿‡åº¦å¤æ‚**ï¼š
```json
// âŒ æ¡ä»¶å¤ªå¤šï¼Œå‡ ä¹ä¸ä¼šè§¦å‘
{
  "signals_all": [
    "ä¿¡å·1", "ä¿¡å·2", "ä¿¡å·3", "ä¿¡å·4", "ä¿¡å·5"
  ]
}
```

**åŸåˆ™**ï¼š
- `signals_all` ä¸è¶…è¿‡ 3 ä¸ª
- `signals_any` é€‚åˆä¹°å–ç‚¹ç­–ç•¥
- `signals_not` ç”¨äºæ’é™¤æ˜æ˜¾ä¸åˆ©æ¡ä»¶

### 4. ç‰ˆæœ¬ç®¡ç†

**å¼€å‘æµç¨‹**ï¼š
1. åˆ›å»º v1 ç‰ˆæœ¬ï¼ŒåŸºç¡€é€»è¾‘
2. å›æµ‹éªŒè¯ï¼Œè®°å½•ç»©æ•ˆ
3. ä¼˜åŒ–å‚æ•°ï¼Œåˆ›å»º v2
4. å¯¹æ¯” v1 vs v2 ç»©æ•ˆ
5. ä¿ç•™æœ€ä½³ç‰ˆæœ¬ï¼Œè®¾ä¸º active

**ç‰ˆæœ¬å·è§„èŒƒ**ï¼š
- v1ï¼šåˆå§‹ç‰ˆæœ¬
- v2ï¼šå‚æ•°ä¼˜åŒ–
- v3ï¼šé€»è¾‘è°ƒæ•´
- v10ï¼šå¤§å¹…é‡æ„

### 5. æ ‡ç­¾ä½¿ç”¨

**æ¨èæ ‡ç­¾**ï¼š
```json
"tags": [
  "trend",           // ç­–ç•¥ç±»å‹
  "long_only",       // äº¤æ˜“æ–¹å‘
  "buypoint",        // ä¿¡å·ç±»å‹
  "aggressive",      // é£æ ¼
  "btc"              // é€‚ç”¨æ ‡çš„
]
```

**æ ‡ç­¾åˆ†ç±»**ï¼š
- **ç±»å‹**ï¼štrend/reversal/arbitrage/multi_factor
- **æ–¹å‘**ï¼šlong_only/short_only/bidirection
- **ä¿¡å·**ï¼šbuypoint/bi_direction/macd/volume
- **é£æ ¼**ï¼šaggressive/conservative/balanced
- **æ ‡çš„**ï¼šbtc/eth/stock/futures

---

## å¸¸è§é—®é¢˜

### Q1: ç­–ç•¥åˆ›å»ºåèƒ½ä¿®æ”¹å—ï¼Ÿ

**A**: å¯ä»¥ä¿®æ”¹ï¼Œä½† `strategy_id` ä¸èƒ½æ”¹ã€‚

```bash
PUT /api/v1/strategy/{strategy_id}
{
  "name": "æ–°åç§°",
  "positions_config": [...]
}
```

å»ºè®®ï¼šé‡å¤§ä¿®æ”¹æ—¶åˆ›å»ºæ–°ç‰ˆæœ¬ï¼ˆv2ï¼‰ï¼Œä¿ç•™æ—§ç‰ˆæœ¬å¯¹æ¯”ã€‚

### Q2: å¦‚ä½•è°ƒè¯•ç­–ç•¥ï¼Ÿ

**A**:
1. åˆ›å»ºç­–ç•¥åç«‹å³å›æµ‹
2. æŸ¥çœ‹äº¤æ˜“æ˜ç»†ï¼Œåˆ†ææ¯ç¬”äº¤æ˜“
3. æ£€æŸ¥ä¿¡å·æ˜¯å¦æ­£ç¡®è§¦å‘
4. è°ƒæ•´å‚æ•°ï¼Œé‡æ–°å›æµ‹

```bash
# 1. åˆ›å»ºç­–ç•¥
POST /api/v1/strategy

# 2. å›æµ‹
POST /api/v1/backtest/czsc
{
  "strategy_id": "xxx",
  "symbol": "BTCUSDT",
  "freq": "15m",
  "start_date": "2025-09-01",
  "end_date": "2025-10-01"
}

# 3. æŸ¥çœ‹äº¤æ˜“æ˜ç»†
# è¿”å›ç»“æœä¸­çš„ trades æ•°ç»„
```

### Q3: ä¿¡å·åç§°æ ¼å¼é”™è¯¯æ€ä¹ˆåŠï¼Ÿ

**A**: CZSC ä¿¡å·åç§°å¿…é¡»ä¸¥æ ¼éµå¾ª 7 æ®µæ ¼å¼ï¼š

**æ­£ç¡®æ ¼å¼**ï¼š`k1_k2_k3_v1_v2_v3_score`ï¼ˆ7æ®µï¼Œç”¨ä¸‹åˆ’çº¿åˆ†éš”ï¼‰

ç¤ºä¾‹ï¼š
- âœ… `15åˆ†é’Ÿ_D1BS_ä¸€ä¹°_ä»»æ„_ä»»æ„_ä»»æ„_0` (7æ®µ)
- âŒ `15åˆ†é’Ÿ_D1BS_ä¸€ä¹°_ä»»æ„_ä»»æ„_0` (6æ®µï¼Œç¼ºå°‘v2)

**è¯´æ˜**ï¼š
- `k1`: å‘¨æœŸï¼ˆ15åˆ†é’Ÿã€æ—¥çº¿ç­‰ï¼‰
- `k2`: ä¿¡å·å‡½æ•°æ ‡è¯†ï¼ˆD1BSã€D0BL9ç­‰ï¼‰
- `k3`: ä¿¡å·å«ä¹‰ï¼ˆä¸€ä¹°ã€å‘ä¸Šç­‰ï¼‰
- `v1, v2, v3`: ä¿¡å·å–å€¼ï¼Œæœªä½¿ç”¨æ—¶å¡«"ä»»æ„"
- `score`: ä¿¡å·å¾—åˆ†ï¼ˆé€šå¸¸ä¸º0ï¼‰

**å‰ç«¯æ³¨æ„**ï¼š
- å‰ç«¯å¯ä¼ è‹±æ–‡å‘¨æœŸï¼ˆ`15m`ï¼‰ï¼ŒAPI ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºä¸­æ–‡ï¼ˆ`15åˆ†é’Ÿ`ï¼‰
- ä½†å¿…é¡»ä¿è¯7æ®µæ ¼å¼ï¼Œå¦åˆ™ä¼šæŠ¥é”™

### Q4: ç­–ç•¥å›æµ‹äº¤æ˜“æ•°ä¸º 0ï¼Ÿ

**A**: å¯èƒ½åŸå› ï¼š
1. **ä¿¡å·åç§°é”™è¯¯** - æ£€æŸ¥ä¿¡å·æ ¼å¼
2. **Factor é€»è¾‘å¤ªä¸¥** - æ”¾å®½æ¡ä»¶æˆ–ä½¿ç”¨ `signals_any`
3. **å›æµ‹æ—¶é—´å¤ªçŸ­** - è‡³å°‘é€‰æ‹© 1 ä¸ªæœˆä»¥ä¸Š
4. **ä¿¡å·å‡½æ•°æœªé…ç½®** - æ£€æŸ¥ `signals_config` æ˜¯å¦åŒ…å«å¯¹åº”å‡½æ•°

### Q5: å¦‚ä½•å®ç°åªåšä¸‰ä¹°ï¼Ÿ

**A**:
```json
{
  "opens": [{
    "operate": "LO",
    "factors": [{
      "signals_all": ["15m_D3BS_ä¸‰ä¹°_ä»»æ„_ä»»æ„_ä»»æ„_0"]
    }]
  }],
  "signals_config": [{
    "name": "czsc.signals.cxt.cxt_third_bs_V230318",
    "freq": "15m"
  }]
}
```

### Q6: å¦‚ä½•é¿å…é¢‘ç¹äº¤æ˜“ï¼Ÿ

**A**: å¢åŠ  `interval` å‚æ•°ï¼š
```json
{
  "interval": 20,  // å¹³ä»“åç­‰å¾… 20 æ ¹ K çº¿
  "timeout": 100,
  "stop_loss": 200
}
```

### Q7: å¤šä¸ª Position å¦‚ä½•å·¥ä½œï¼Ÿ

**A**:
```json
{
  "positions_config": [
    {
      "name": "æ¿€è¿›ç­–ç•¥",
      "interval": 5,
      "opens": [...]
    },
    {
      "name": "ä¿å®ˆç­–ç•¥",
      "interval": 20,
      "opens": [...]
    }
  ],
  "ensemble_method": "mean"  // ä¸¤ä¸ªç­–ç•¥çš„æƒé‡å–å¹³å‡
}
```

å¤šç­–ç•¥ä¼šæŒ‰ `ensemble_method` é›†æˆï¼š
- `mean`: æƒé‡å¹³å‡
- `vote`: æŠ•ç¥¨è¡¨å†³
- `max`: å–æœ€å¤§å€¼

### Q8: å‰ç«¯å¦‚ä½•è·å–ä¿¡å·åç§°ï¼Ÿ

**A**:
1. è°ƒç”¨ä¿¡å·åˆ—è¡¨æ¥å£ï¼š
   ```bash
   GET /api/v1/signals/list
   ```

2. æˆ–å‚è€ƒæ–‡æ¡£ä¸­çš„[ä¿¡å·å‡½æ•°å‚è€ƒ](#ä¿¡å·å‡½æ•°å‚è€ƒ)

3. é€šç”¨æ ¼å¼ï¼š`{å‘¨æœŸ}_{ä¿¡å·å‡½æ•°}_{çŠ¶æ€}`

### Q9: å¦‚ä½•å®ç°æ­¢ç›ˆï¼Ÿ

**A**: ä¸¤ç§æ–¹å¼ï¼š

**æ–¹å¼1ï¼šä½¿ç”¨è¶…æ—¶**
```json
{
  "timeout": 50,  // æŒä»“ 50 æ ¹ K çº¿åè‡ªåŠ¨å¹³ä»“
  "stop_loss": 200
}
```

**æ–¹å¼2ï¼šä½¿ç”¨ç‰¹å®šä¿¡å·**ï¼ˆéœ€è¦è‡ªå®šä¹‰ä¿¡å·å‡½æ•°ï¼‰
```json
{
  "exits": [{
    "operate": "LE",
    "factors": [{
      "signals_any": [
        "15m_PROFIT_5%_ä»»æ„_ä»»æ„_ä»»æ„_0",  // è‡ªå®šä¹‰ç›ˆåˆ©ä¿¡å·ï¼ˆéœ€å¼€å‘ï¼‰
        "15m_D0BL9_V230228_å‘ä¸‹_ä»»æ„_ä»»æ„_ä»»æ„_0"
      ]
    }]
  }]
}
```

### Q10: ç­–ç•¥å¯ä»¥è·¨æ ‡çš„ä½¿ç”¨å—ï¼Ÿ

**A**: å¯ä»¥ï¼Position é…ç½®ä¸­çš„ `symbol` å­—æ®µä¼šè¢«å›æµ‹æ—¶çš„å‚æ•°è¦†ç›–ï¼š

```json
// ç­–ç•¥åˆ›å»ºæ—¶
{
  "positions_config": [{
    "symbol": "BTCUSDT"  // è¿™æ˜¯é»˜è®¤å€¼
  }]
}

// å›æµ‹æ—¶å¯ä»¥æ¢æ ‡çš„
{
  "symbol": "ETHUSDT",  // ä½¿ç”¨ ETH å›æµ‹
  "strategy_id": "xxx"
}
```

---

## é™„å½•ï¼šAPI ç«¯ç‚¹

### ç­–ç•¥ç®¡ç†

```bash
# åˆ›å»ºç­–ç•¥
POST /api/v1/strategy

# æŸ¥è¯¢åˆ—è¡¨
GET /api/v1/strategy/list?limit=20&category=trend

# æŸ¥è¯¢è¯¦æƒ…
GET /api/v1/strategy/{strategy_id}

# æ›´æ–°ç­–ç•¥
PUT /api/v1/strategy/{strategy_id}

# åˆ é™¤ç­–ç•¥
DELETE /api/v1/strategy/{strategy_id}?hard_delete=false
```

### å›æµ‹

```bash
# CZSC å›æµ‹
POST /api/v1/backtest/czsc

# å›æµ‹åˆ—è¡¨
GET /api/v1/backtest/list?limit=20

# å›æµ‹è¯¦æƒ…
GET /api/v1/backtest/{task_id}
```

### ä¿¡å·

```bash
# ä¿¡å·åˆ—è¡¨
GET /api/v1/signals/list

# ä¿¡å·æŸ¥è¯¢
POST /api/v1/signals/query
```

---

## è”ç³»å’Œåé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ [API_REFERENCE.md](./API_REFERENCE.md)
2. æŸ¥çœ‹ Swagger æ–‡æ¡£ï¼šhttp://localhost:8000/docs
3. æäº¤ Issue æˆ–è”ç³»å¼€å‘å›¢é˜Ÿ

---

**ç¥ä½ ç­–ç•¥å¼€å‘é¡ºåˆ©ï¼** ğŸš€
